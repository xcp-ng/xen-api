#!/bin/sh

remote=0

while [ -n "$1" ]
do
  case "$1" in
    --remote=*)
      remote=1
      host=${1#--remote=};;
    --noremote)
      remote=0;;
  esac
  shift
done


if [ $remote -eq 1 ]; then
  echo "# /etc/rsyslog.d/remote.conf is auto-generated by xe-syslog-reconfigure" > /etc/rsyslog.d/remote.conf
  echo "*.* @$host" >> /etc/rsyslog.d/remote.conf
else
  rm -f /etc/rsyslog.d/remote.conf
fi

systemctl restart rsyslog
